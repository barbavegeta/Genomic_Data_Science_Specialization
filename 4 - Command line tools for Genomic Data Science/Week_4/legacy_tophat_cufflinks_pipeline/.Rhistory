library(BiocManager)
print("hello, world!")
print("hello. world!")
prin("hello")
readline("Whats you name?")
print("Hello", name)
name <- readline("Whtas your name?")
SB
name <- readline("What's your name?")
print("Hello", name)
print(greeting)
name <- readline("What's your name?")
greeting <- paste("Hello, ", name)
print(greeting)
print("Hello", name)
print(greeting)
name <- readline("What's your name? ")
SBgreeting <- paste("Hello", name)
print(greeting)
name <- readline("What's your name? ")
SBgreeting <- paste("Hello", name, sep="")
print(greeting)
print(greeting)
print(greeting)
print(greeting)
print(greeting)
print(greeting)
print(greeting)
print(greeting)
name <- readline("What's your name? ")
greeting <- paste0"Hello", name, sep="")
print(greeting)
fruits <- c("apple", "banana", "mango")
price <- c(4,3,2,8)
nature <- as.factor(c("Local", "Exotic", "Local", "Exotic"))
df_fruits <- data.frame(row.names = fruits,price,nature)
fruits <- c("apple", "banana", "orangemango")
> fruits <- c("apple", "banana", "orange" "mango")
> > fruits <- c("apple", "banana", "orange" "mango")
fruits[ !fruits == "orangemango"]
fruits <- c("orang", "mango")
fruits
fruits <-  c("orang", "mango", "apple", "banana")
fruits
df_fruits <- data.frame(row.names = fruits, price, nature)
df_fruits
levels(nature)
nlevels(nature)
dim(df_fruits)
sapply(df_fruits, class)
df_fruits[1:4,1]
iris
Iris <- read.table("iris.txt")
head(iris)
library(datasets)
data("iris")
data(iris)
datasets
library()
summary(iris)
summary(iris$Species)
summary(Petal.length)
summary(iris$Petal.length)
summary(iris$Petal.Length)
names(iris)
sapply(iris, class)
str(iris)
setosa1 <- iris[iris$Species == "setosa",]
head(setosa1)
identical(setosa1, setosa.sub1)
install.packages("dplyr")
library(dplyr)
dplyr
dplyr?
2
help("dplyr")
setosa.filt <- filter(iris, Species == "setosa")
head(setosa.filt)
nrow(setosa)
nrow(setosa.filt)
setosa <- c(iris, Species == "setosa")
setosa.filt.pl2 <- filter(iris, Species == "setosa", Petal.Length < 2)
setosa.filt.pl2 <- filter(iris, Species == "setosa", Petal.Length < 2)
setosa.filt.pl2
Iris.select <- select(iris, Sepal.Length, Petal.Length)
Iris.select
head(Iris.select)
library(datasets)
library(help = "graphics")
hist(iris$Sepal.Length)
methods(plot)
plot(iris)
boxplot(iris)
boxplot(iris$Sepal.Width, iris$Petal.Width)
boxplot(iris$Sepal.Width, iris$Petal.Width, main="Boxplot Petal.Width vs. Sepal.Width", col="#ADD8E6", border="#2f4f4f")
library(ggplot2)
library(RColorBrewer)
install.packages("viridis")
install.packages(c("BH", "BiocManager", "bslib", "cachem", "cli", "colorspace", "commonmark", "cpp11", "crayon", "data.table", "deldir", "digest", "evaluate", "fansi", "farver", "fastmap", "fontawesome", "fs", "ggplot2", "glue", "gtable", "hexbin", "highr", "htmltools", "httpuv", "IDPmisc", "interp", "jpeg", "jsonlite", "knitr", "labeling", "later", "lifecycle", "lintr", "matrixStats", "mime", "munsell", "pillar", "pkgbuild", "pkgload", "plyr", "processx", "promises", "ps", "purrr", "R.oo", "R.utils", "R6", "Rcpp", "RcppEigen", "RcppTOML", "reticulate", "rlang", "roxygen2", "rprojroot", "sass", "scales", "shiny", "stringi", "tidyselect", "utf8", "withr", "xfun", "XML", "xml2", "yaml"))
install.packages(c("BH", "BiocManager", "bslib", "cachem", "cli", "colorspace", "commonmark", "cpp11", "crayon", "data.table", "deldir", "digest", "evaluate", "fansi", "farver", "fastmap", "fontawesome", "fs", "ggplot2", "glue", "gtable", "hexbin", "highr", "htmltools", "httpuv", "IDPmisc", "interp", "jpeg", "jsonlite", "knitr", "labeling", "later", "lifecycle", "lintr", "matrixStats", "mime", "munsell", "pillar", "pkgbuild", "pkgload", "plyr", "processx", "promises", "ps", "purrr", "R.oo", "R.utils", "R6", "Rcpp", "RcppEigen", "RcppTOML", "reticulate", "rlang", "roxygen2", "rprojroot", "sass", "scales", "shiny", "stringi", "tidyselect", "utf8", "withr", "xfun", "XML", "xml2", "yaml"))
install.packages(c("BH", "BiocManager", "bslib", "cachem", "cli", "colorspace", "commonmark", "cpp11", "crayon", "data.table", "deldir", "digest", "evaluate", "fansi", "farver", "fastmap", "fontawesome", "fs", "ggplot2", "glue", "gtable", "hexbin", "highr", "htmltools", "httpuv", "IDPmisc", "interp", "jpeg", "jsonlite", "knitr", "labeling", "later", "lifecycle", "lintr", "matrixStats", "mime", "munsell", "pillar", "pkgbuild", "pkgload", "plyr", "processx", "promises", "ps", "purrr", "R.oo", "R.utils", "R6", "Rcpp", "RcppEigen", "RcppTOML", "reticulate", "rlang", "roxygen2", "rprojroot", "sass", "scales", "shiny", "stringi", "tidyselect", "utf8", "withr", "xfun", "XML", "xml2", "yaml"))
install.packages("viridis")
library(viridis)
getwd()
cd ..
cd ".."
cd "barba/Downloads"
iris_length <- iris %>% select(Sepal.Length, Petal.Length)
head(iris)
install.packages("dplyr")
install.packages("dplyr")
library(dplyr)
iris_length <- iris %>% select(Sepal.Length, Petal.Length)
head(iris_length)
ggplot(data = iris,aes(x = Sepal.Length, y = Petal.Length)) +
geom_point()
install.packages("ggplot")
install.packages("installr")
library(installr)
updateR()
updateR()
updateR()
library(dplyr)
install.packages(c("ggplot2", "pillar", "rlang"))
library(dplyr)
library(tidyselect)
library(tibble)
install.packages("tidyverse")
library(tidyverse)
install.packages("rlang")
library(tidyverse)
install.packages("devtools")
devtools::install_github("r-lib/conflicted")
library(tidyverse)
ls
list.files()
cwd(/mnt/d/Download 2/Bioinformatics Wellcome/Genomics/Week1/variants_long_table_and_multiqc_report)
install.packages("rmarkdown")
library(tidyverse)
library(palmerpenguins)
library(palmerpenguins)
tinytex::install_tinytex()
tinytex::install_tinytex()
Y
install.packages("BiocManager")
library(DESeq2)
BiocManager::install("DESeq2")
BiocManager::install("edgeR")
dds <- DESeqDataSetFromMatrix(
countData = counts_matrix,
colData = coldata,
design = ~ condition # Defines your experimental design
)
coldata <- data.frame(
row.names = sample_names,
condition = condition
)
# --- 6. Visualize Results ---
# MA-plot: Visualizes log2 fold changes (M) against mean of normalized counts (A).
# Points colored red are significantly differentially expressed (padj < 0.1 by default).
plotMA(results_day16_vs_day8, main="Day16 vs Day8 MA-plot")
# You might also want to save the results to a CSV file
write.csv(as.data.frame(results_ordered), file="deseq2_results_day16_vs_day8.csv", row.names=TRUE)
# You might also want to save the results to a CSV file
write.csv(as.data.frame(results_ordered), file="deseq2_results_day16_vs_day8.csv", row.names=TRUE)
# You might also want to save the results to a CSV file
write.csv(as.data.frame(results_ordered), file="deseq2_results_day16_vs_day8.csv", row.names=TRUE)
library(DESeq2)
library(DESeq2)
library(DESeq2)
library(readr) # Recommended for fast and reliable CSV reading
library(dplyr) # Good practice for data manipulation
# Read the gene count matrix.
# 'col_names = TRUE' (default) ensures the first row is treated as headers.
counts_data <- read_csv("gene_count_matrix.csv")
# Important check: Ensure all counts are non-negative integers
if (any(counts_matrix < 0) || any(counts_matrix != floor(counts_matrix))) {
warning("Count matrix contains non-integer or negative values. This might cause issues with DESeq2.")
# You might want to filter out rows with all zero counts before DESeq2,
# or genes with very low overall counts.
# For example, keep only rows that have at least 10 reads total across all samples
# counts_matrix <- counts_matrix[rowSums(counts_matrix) >= 10, ]
}
# --- 2. Create ColData (Sample Information) ---
# This data frame describes your samples and their experimental conditions.
# The row names MUST exactly match the column names of your counts_matrix.
sample_names <- c("Day8", "Day16") # These MUST match the actual column headers from prepDE.py output
condition <- factor(c("Day8", "Day16")) # Defines your experimental groups
coldata <- data.frame(
row.names = sample_names,
condition = condition # This is your primary experimental variable
)
# Crucial check: Verify that row names of coldata match column names of counts_matrix
if (!all(rownames(coldata) == colnames(counts_matrix))) {
stop("Sample names in coldata do not match column names in counts_matrix. Please check for typos or order.")
}
# --- 3. Construct DESeqDataSet Object ---
# This object combines your count data and sample information.
# The 'design' formula specifies how the experimental factors affect gene expression.
dds <- DESeqDataSetFromMatrix(
countData = counts_matrix,
colData = coldata,
design = ~ condition # This design tests for differences between 'Day8' and 'Day16'
)
# --- 4. Run DESeq2 Analysis ---
# This single function performs normalization, dispersion estimation,
# and differential expression testing.
print("Running DESeq2 analysis...")
dds <- DESeq(dds)
print("DESeq2 analysis complete.")
# --- 5. Extract Results ---
# Get the results for specific comparisons.
# 'contrast' specifies which comparison to make: c("variable", "level_numerator", "level_denominator")
# Here, it's "Day16" (numerator) compared to "Day8" (denominator).
# A positive log2FoldChange means higher expression in Day16 relative to Day8.
results_day16_vs_day8 <- results(dds, contrast = c("condition", "Day16", "Day8"))
# Order results by adjusted p-value (padj) for easier interpretation
results_ordered <- results_day16_vs_day8[order(results_day16_vs_day8$padj),]
# View the top differentially expressed genes
print("Top differentially expressed genes:")
print(head(results_ordered))
# Summarize results
print(summary(results_day16_vs_day8))
# --- 6. Visualize Results ---
# MA-plot: Visualizes log2 fold changes (M) against mean of normalized counts (A).
# Points colored red are significantly differentially expressed (padj < 0.1 by default).
plotMA(results_day16_vs_day8, main="Day16 vs Day8 MA-plot")
# You might also want to save the results to a CSV file
write.csv(as.data.frame(results_ordered), file="deseq2_results_day16_vs_day8.csv", row.names=TRUE)
print("Differential expression analysis script finished.")
library(DESeq2)
library(readr) # Recommended for fast and reliable CSV reading
library(dplyr) # Good practice for data manipulation
# Read the gene count matrix.
# 'col_names = TRUE' (default) ensures the first row is treated as headers.
counts_data <- read_csv("gene_count_matrix.csv")
# Set the gene IDs as row names and remove the gene_id column from the data frame
# DESeq2 expects count data with gene IDs as row names.
if ("gene_id" %in% colnames(counts_data)) {
rownames(counts_data) <- counts_data$gene_id
counts_data$gene_id <- NULL
} else {
stop("Error: 'gene_id' column not found. Please check your gene_count_matrix.csv file.")
}
# Convert to a matrix and ensure counts are integers
# DESeq2 requires integer counts. round() is good, but make sure no negative values
# or very small floats might cause issues if not strictly integers.
counts_matrix <- as.matrix(counts_data)
counts_matrix <- round(counts_matrix)
# Important check: Ensure all counts are non-negative integers
if (any(counts_matrix < 0) || any(counts_matrix != floor(counts_matrix))) {
warning("Count matrix contains non-integer or negative values. This might cause issues with DESeq2.")
# You might want to filter out rows with all zero counts before DESeq2,
# or genes with very low overall counts.
# For example, keep only rows that have at least 10 reads total across all samples
# counts_matrix <- counts_matrix[rowSums(counts_matrix) >= 10, ]
}
setwd("C:/Users/barba/OneDrive - University College London/Bioinformatics/Coursera/Genomic Data Science Specialization/4 - Command line tools for Genomic Data Science/Week-4/test2") # Replace with the actual path to your file
# Read the gene count matrix.
# 'col_names = TRUE' (default) ensures the first row is treated as headers.
counts_data <- read_csv("gene_count_matrix.csv")
# Set the gene IDs as row names and remove the gene_id column from the data frame
# DESeq2 expects count data with gene IDs as row names.
if ("gene_id" %in% colnames(counts_data)) {
rownames(counts_data) <- counts_data$gene_id
counts_data$gene_id <- NULL
} else {
stop("Error: 'gene_id' column not found. Please check your gene_count_matrix.csv file.")
}
# Convert to a matrix and ensure counts are integers
# DESeq2 requires integer counts. round() is good, but make sure no negative values
# or very small floats might cause issues if not strictly integers.
counts_matrix <- as.matrix(counts_data)
counts_matrix <- round(counts_matrix)
# Important check: Ensure all counts are non-negative integers
if (any(counts_matrix < 0) || any(counts_matrix != floor(counts_matrix))) {
warning("Count matrix contains non-integer or negative values. This might cause issues with DESeq2.")
# You might want to filter out rows with all zero counts before DESeq2,
# or genes with very low overall counts.
# For example, keep only rows that have at least 10 reads total across all samples
# counts_matrix <- counts_matrix[rowSums(counts_matrix) >= 10, ]
}
# --- 2. Create ColData (Sample Information) ---
# This data frame describes your samples and their experimental conditions.
# The row names MUST exactly match the column names of your counts_matrix.
sample_names <- c("Day8", "Day16") # These MUST match the actual column headers from prepDE.py output
condition <- factor(c("Day8", "Day16")) # Defines your experimental groups
coldata <- data.frame(
row.names = sample_names,
condition = condition # This is your primary experimental variable
)
# Crucial check: Verify that row names of coldata match column names of counts_matrix
if (!all(rownames(coldata) == colnames(counts_matrix))) {
stop("Sample names in coldata do not match column names in counts_matrix. Please check for typos or order.")
}
# --- 3. Construct DESeqDataSet Object ---
# This object combines your count data and sample information.
# The 'design' formula specifies how the experimental factors affect gene expression.
dds <- DESeqDataSetFromMatrix(
countData = counts_matrix,
colData = coldata,
design = ~ condition # This design tests for differences between 'Day8' and 'Day16'
)
# --- 4. Run DESeq2 Analysis ---
# This single function performs normalization, dispersion estimation,
# and differential expression testing.
print("Running DESeq2 analysis...")
dds <- DESeq(dds)
print("DESeq2 analysis complete.")
# --- 5. Extract Results ---
# Get the results for specific comparisons.
# 'contrast' specifies which comparison to make: c("variable", "level_numerator", "level_denominator")
# Here, it's "Day16" (numerator) compared to "Day8" (denominator).
# A positive log2FoldChange means higher expression in Day16 relative to Day8.
results_day16_vs_day8 <- results(dds, contrast = c("condition", "Day16", "Day8"))
# Order results by adjusted p-value (padj) for easier interpretation
results_ordered <- results_day16_vs_day8[order(results_day16_vs_day8$padj),]
# View the top differentially expressed genes
print("Top differentially expressed genes:")
print(head(results_ordered))
# Summarize results
print(summary(results_day16_vs_day8))
# --- 6. Visualize Results ---
# MA-plot: Visualizes log2 fold changes (M) against mean of normalized counts (A).
# Points colored red are significantly differentially expressed (padj < 0.1 by default).
plotMA(results_day16_vs_day8, main="Day16 vs Day8 MA-plot")
# You might also want to save the results to a CSV file
write.csv(as.data.frame(results_ordered), file="deseq2_results_day16_vs_day8.csv", row.names=TRUE)
print("Differential expression analysis script finished.")
setwd("C:/Users/barba/OneDrive - University College London/Bioinformatics/Coursera/Genomic Data Science Specialization/4 - Command line tools for Genomic Data Science/Week-4/test2") # Replace with the actual path to your file
# Read the gene count matrix.
# 'col_names = TRUE' (default) ensures the first row is treated as headers.
counts_data <- read_csv("gene_count_matrix.csv")
# Set the gene IDs as row names and remove the gene_id column from the data frame
# DESeq2 expects count data with gene IDs as row names.
if ("gene_id" %in% colnames(counts_data)) {
rownames(counts_data) <- counts_data$gene_id
counts_data$gene_id <- NULL
} else {
stop("Error: 'gene_id' column not found. Please check your gene_count_matrix.csv file.")
}
# Convert to a matrix and ensure counts are integers
# DESeq2 requires integer counts. round() is good, but make sure no negative values
# or very small floats might cause issues if not strictly integers.
counts_matrix <- as.matrix(counts_data)
counts_matrix <- round(counts_matrix)
# Important check: Ensure all counts are non-negative integers
if (any(counts_matrix < 0) || any(counts_matrix != floor(counts_matrix))) {
warning("Count matrix contains non-integer or negative values. This might cause issues with DESeq2.")
}
# --- 2. Create ColData (Sample Information) ---
# Define your sample names in the desired order for your coldata
# This order is usually the one you prefer for comparisons (e.g., control first, then treatment)
# Let's stick with Day8 then Day16 for coldata.
sample_names <- c("Day8", "Day16")
condition <- factor(c("Day8", "Day16"), levels = c("Day8", "Day16")) # Explicitly define levels for factor
coldata <- data.frame(
row.names = sample_names,
condition = condition
)
# --- CRITICAL FIX: Reorder counts_matrix columns to match coldata row names ---
# This ensures the sample order is consistent.
# Your counts_matrix currently has Day16, Day8. We need Day8, Day16.
counts_matrix <- counts_matrix[, rownames(coldata)]
# Now, the crucial check will pass if the above reordering was correct
if (!all(rownames(coldata) == colnames(counts_matrix))) {
stop("FATAL ERROR: Sample names in coldata still do not match column names in counts_matrix after reordering. Review your data and script.")
} else {
print("Sample order in colData and countData confirmed to match.")
}
# --- 3. Construct DESeqDataSet Object ---
dds <- DESeqDataSetFromMatrix(
countData = counts_matrix,
colData = coldata,
design = ~ condition # Defines your experimental design
)
# --- 4. Run DESeq2 Analysis ---
# This single function performs normalization, dispersion estimation,
# and differential expression testing.
print("Running DESeq2 analysis...")
dds <- DESeq(dds)
print("DESeq2 analysis complete.")
# --- 5. Extract Results ---
# Get the results for specific comparisons.
# 'contrast' specifies which comparison to make: c("variable", "level_numerator", "level_denominator")
# Here, it's "Day16" (numerator) compared to "Day8" (denominator).
# A positive log2FoldChange means higher expression in Day16 relative to Day8.
results_day16_vs_day8 <- results(dds, contrast = c("condition", "Day16", "Day8"))
# Order results by adjusted p-value (padj) for easier interpretation
results_ordered <- results_day16_vs_day8[order(results_day16_vs_day8$padj),]
# View the top differentially expressed genes
print("Top differentially expressed genes:")
print(head(results_ordered))
# Summarize results
print(summary(results_day16_vs_day8))
# --- 6. Visualize Results ---
# MA-plot: Visualizes log2 fold changes (M) against mean of normalized counts (A).
# Points colored red are significantly differentially expressed (padj < 0.1 by default).
plotMA(results_day16_vs_day8, main="Day16 vs Day8 MA-plot")
# You might also want to save the results to a CSV file
write.csv(as.data.frame(results_ordered), file="deseq2_results_day16_vs_day8.csv", row.names=TRUE)
print("Differential expression analysis script finished.")
library(DESeq2)
library(readr) # Recommended for fast and reliable CSV reading
library(dplyr) # Good practice for data manipulation
# --- 1. Set Working Directory ---
# IMPORTANT: Replace this path with the actual directory where your 'gene_count_matrix.csv' is located.
# Use forward slashes (/) or double backslashes (\\) for paths on Windows.
setwd("C:/Users/barba/OneDrive - University College London/Bioinformatics/Coursera/Genomic Data Science Specialization/4 - Command line tools for Genomic Data Science/Week-4/test2")
# Read the gene count matrix.
# 'col_names = TRUE' (default) ensures the first row is treated as headers.
counts_data <- read_csv("gene_count_matrix.csv")
# Verify the structure after reading (optional, but good for debugging)
print(head(counts_data))
print(colnames(counts_data))
# Set the gene IDs as row names and remove the gene_id column from the data frame
# DESeq2 expects count data with gene IDs as row names.
if ("gene_id" %in% colnames(counts_data)) {
rownames(counts_data) <- counts_data$gene_id
counts_data$gene_id <- NULL
} else {
stop("Error: 'gene_id' column not found. Please check your gene_count_matrix.csv file.")
}
# Convert to a matrix and ensure counts are integers
# DESeq2 requires integer counts. round() is good, but make sure no negative values
# or very small floats might cause issues if not strictly integers.
counts_matrix <- as.matrix(counts_data)
counts_matrix <- round(counts_matrix)
# Important check: Ensure all counts are non-negative integers
if (any(counts_matrix < 0) || any(counts_matrix != floor(counts_matrix))) {
warning("Count matrix contains non-integer or negative values. This might cause issues with DESeq2.")
}
# --- 3. Create ColData (Sample Information) ---
# This data frame describes your samples and their experimental conditions.
# The row names MUST exactly match the column names of your counts_matrix.
# Define your sample names in the desired order for your coldata
# (e.g., control first, then treatment if you want Day8 as baseline).
sample_names <- c("Day8", "Day16")
# Explicitly define levels for the factor to control the order for comparisons
condition <- factor(c("Day8", "Day16"), levels = c("Day8", "Day16"))
coldata <- data.frame(
row.names = sample_names,
condition = condition # This is your primary experimental variable
)
# --- CRITICAL FIX: Reorder counts_matrix columns to match coldata row names ---
# This ensures the sample order is consistent, which is crucial for DESeq2.
# Your 'read_csv' output showed 'Day16, Day8' but we want 'Day8, Day16' in colData.
counts_matrix <- counts_matrix[, rownames(coldata)]
# Now, the crucial check will pass if the above reordering was correct
if (!all(rownames(coldata) == colnames(counts_matrix))) {
stop("FATAL ERROR: Sample names in colData still do not match column names in counts_matrix after reordering. Review your data and script.")
} else {
print("Sample order in colData and countData confirmed to match.")
}
# --- 4. Construct DESeqDataSet Object for No-Replicate Analysis ---
# IMPORTANT: With only one sample per condition, DESeq2 CANNOT estimate dispersion
# and therefore CANNOT perform statistical differential expression testing (no p-values).
# We set the design to ~1 to tell DESeq2 there are no experimental groups to compare
# for statistical testing purposes (only for size factor estimation).
print("Constructing DESeqDataSet object for no-replicate analysis...")
dds <- DESeqDataSetFromMatrix(
countData = counts_matrix,
colData = coldata,
design = ~ 1 # This design is used when you have no replicates for statistical comparison
)
print("DESeqDataSet object created.")
# --- 5. Estimate Size Factors and Get Normalized Counts ---
# Even without replicates for statistical testing, DESeq2 can still perform
# size factor estimation to normalize for library size differences.
print("Estimating size factors for normalization...")
dds <- estimateSizeFactors(dds)
print("Size factor estimation complete.")
# Get normalized counts
normalized_counts <- counts(dds, normalized=TRUE)
print("Head of normalized counts:")
print(head(normalized_counts))
# --- 6. Calculate Log2 Fold Change Manually (No P-values) ---
# Since DESeq2 cannot perform statistical testing without replicates,
# we manually calculate the log2 fold change based on normalized counts.
# Add a small pseudo-count to avoid log(0) issues for genes with zero counts.
pseudo_count <- 1
# Calculate fold change for Day16 vs Day8
# A positive log2FoldChange means higher expression in Day16 relative to Day8.
log2_fold_change <- log2( (normalized_counts[, "Day16"] + pseudo_count) /
(normalized_counts[, "Day8"] + pseudo_count) )
# Create a data frame for these manual results
# This table will NOT have 'stat', 'pvalue', or 'padj' columns.
manual_results <- data.frame(
baseMean = rowMeans(normalized_counts),
log2FoldChange = log2_fold_change,
row.names = rownames(normalized_counts) # Gene IDs as row names
)
# Order results by the absolute log2FoldChange to see the largest changes first
manual_results_ordered <- manual_results[order(abs(manual_results$log2FoldChange), decreasing = TRUE), ]
print("Manual Log2 Fold Change Results (TOP 10 - no p-values/significance):")
print(head(manual_results_ordered, 10)) # Print top 10 for better overview
# --- 7. Save Results ---
# Save the normalized counts
write.csv(normalized_counts, file="normalized_counts.csv", row.names=TRUE)
print("Normalized counts saved to 'normalized_counts.csv'")
# Save the manual log2 fold change results
write.csv(manual_results_ordered, file="manual_log2_fold_change_results.csv", row.names=TRUE)
print("Manual log2 fold change results saved to 'manual_log2_fold_change_results.csv'")
# Example of a very basic custom MA-like plot (no significance coloring)
plot(manual_results$baseMean, manual_results$log2FoldChange,
log="x", # Log scale for baseMean (X-axis)
xlab="Mean of Normalized Counts",
ylab="Log2 Fold Change (Day16 vs Day8)",
main="MA-plot (No Replicates - Descriptive Only)",
pch=20, cex=0.7, col="darkblue")
abline(h=0, col="red", lty=2) # Add a horizontal line at 0 fold change
print("Analysis script finished. Remember results are descriptive only due to lack of replicates.")
